# –ü–æ–ª—É—á–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ perplexity_client
            try:
                from perplexity_client import PerplexityClient
                
                perplexity = PerplexityClient()
                news_results = await perplexity.search_ticker_news(ticker, hours=24)
                
                if not news_results:
                    result_text = f"""üì∞ **–ù–û–í–û–°–¢–ò –ü–û {ticker}**

üè¢ **–ö–æ–º–ø–∞–Ω–∏—è:** {ticker}
‚ùå –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.

üí° –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
- –ù–µ—Ç –∑–Ω–∞—á–∏–º—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –æ –∫–æ–º–ø–∞–Ω–∏–∏
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- –¢–∏–∫–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º

üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
- –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∏–∫–µ—Ä—ã: GAZP, YNDX, LKOH
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/price {ticker}` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–Ω—ã

‚ö†Ô∏è **–î–∏—Å–∫–ª–µ–π–º–µ—Ä:** –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è."""
                else:
                    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏
                    sources = list(set(news.get('source', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ') for news in news_results if news.get('source')))
                    sources_text = ', '.join(sources[:3])
                    if len(sources) > 3:
                        sources_text += f" –∏ –µ—â—ë {len(sources) - 3}"
                    
                    result_text = f"""üì∞ **–ù–û–í–û–°–¢–ò –ü–û {ticker}**

üè¢ **–ö–æ–º–ø–∞–Ω–∏—è:** {ticker}
üîç **–ù–∞–π–¥–µ–Ω–æ –Ω–æ–≤–æ—Å—Ç–µ–π:** {len(news_results)}
‚è∞ **–ü–µ—Ä–∏–æ–¥:** –ü–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
üåê **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** {sources_text}

üìã **–¢–û–ü-{min(3, len(news_results))} –ù–û–í–û–°–¢–ï–ô:**

"""
                    for i, news in enumerate(news_results[:3], 1):
                        title = news.get('title', '–ë–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞')
                        summary = news.get('summary', '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç')
                        source = news.get('source', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫')
                        
                        # –û–±—Ä–µ–∑–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
                        if len(title) > 80:
                            title = title[:77] + "..."
                        if len(summary) > 150:
                            summary = summary[:147] + "..."
                        
                        result_text += f"""**{i}. {title}**
üìù {summary}
üåê {source}

"""
                    
                    if len(news_results) > 3:
                        result_text += f"üìã –ò –µ—â—ë {len(news_results) - 3} –Ω–æ–≤–æ—Å—Ç–µ–π...\n\n"
                    
                    result_text += f"""üïê **–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** {ticker} –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

üí° **–ß—Ç–æ –¥–∞–ª—å—à–µ?**
- `/price {ticker}` - —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
- `/accounts` - —Ç–æ—Ä–≥–æ–≤—ã–µ —Å—á–µ—Ç–∞
- `/status` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

‚ö†Ô∏è **–î–∏—Å–∫–ª–µ–π–º–µ—Ä:** –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è. –ù–µ —è–≤–ª—è–µ—Ç—Å—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π."""
                
            except ImportError:
                result_text = f"""‚ùå **PERPLEXITY CLIENT –ù–ï –ù–ê–ô–î–ï–ù**

üîß –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `perplexity_client.py`

üí° –ü–æ–∫–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- `/price {ticker}` - —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –∞–∫—Ü–∏–∏
- `/accounts` - —Ç–æ—Ä–≥–æ–≤—ã–µ —Å—á–µ—Ç–∞
- `/status` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º"""
            
            except Exception as api_error:
                logger.error(f"–û—à–∏–±–∫–∞ Perplexity API –¥–ª—è {ticker}: {api_error}")
                result_text = f"""‚ùå **–û–®–ò–ë–ö–ê –ü–û–õ–£–ß–ï–ù–ò–Ø –ù–û–í–û–°–¢–ï–ô {ticker}**

üîç –ü—Ä–∏—á–∏–Ω–∞: {str(api_error)}

üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
- –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/status` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Ç–∏–∫–µ—Ä: GAZP, YNDX

üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
- `/price {ticker}` - —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
- `/accounts` - —Ç–æ—Ä–≥–æ–≤—ã–µ —Å—á–µ—Ç–∞"""