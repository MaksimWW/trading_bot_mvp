–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Ñ–∞–π–ª src/telegram_bot.py. –ù–∞–π–¥–∏ –º–µ—Ç–æ–¥ setup_handlers –∏ –¥–æ–±–∞–≤—å –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É –ø–æ—Å–ª–µ portfolio –∫–æ–º–∞–Ω–¥—ã:

        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º
        app.add_handler(CommandHandler("portfolio", self.portfolio_command))
        app.add_handler(CommandHandler("analytics", self.analytics_command))
        app.add_handler(CommandHandler("buy", self.buy_command))

–ó–∞—Ç–µ–º –Ω–∞–π–¥–∏ –º–µ—Ç–æ–¥ help_command –∏ –¥–æ–±–∞–≤—å –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ —Å–µ–∫—Ü–∏—é "üíº –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–†–¢–§–ï–õ–ï–ú:":

- `/analytics` - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è (Sharpe, VaR, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)

–ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ analytics_command –ø–µ—Ä–µ–¥ –º–µ—Ç–æ–¥–æ–º unknown_command:

    async def analytics_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /analytics."""
        loading_msg = await update.message.reply_text(
            "üìä –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è...\n"
            "üî¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ —Ä–∏—Å–∫–∏...\n"
            "üìà –í—ã—á–∏—Å–ª—è—é Sharpe ratio –∏ VaR...",
            parse_mode=ParseMode.MARKDOWN
        )
        
        try:
            # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Portfolio Analytics
            from portfolio_analytics import PortfolioAnalytics
            
            analytics = PortfolioAnalytics(self.portfolio_manager)
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞
            days = 30
            if context.args and context.args[0].isdigit():
                days = min(90, max(7, int(context.args[0])))
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏
            metrics = await analytics.calculate_portfolio_metrics(days=days)
            
            # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è Telegram
            result_text = analytics.format_metrics_for_telegram(metrics)
            
            await loading_msg.edit_text(
                result_text,
                parse_mode=ParseMode.MARKDOWN
            )
            
            logger.info(f"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: {metrics.positions_count} –ø–æ–∑–∏—Ü–∏–π, "
                       f"Sharpe {metrics.sharpe_ratio:.2f}")
            
        except Exception as e:
            error_msg = "‚ùå *–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è*\n\n"
            error_msg += f"–ü—Ä–∏—á–∏–Ω–∞: {str(e)}\n\n"
            error_msg += "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:\n"
            error_msg += "‚Ä¢ –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –µ—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ\n"
            error_msg += "‚Ä¢ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥\n"
            error_msg += "‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /portfolio –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∑–∏—Ü–∏–π"
            
            await loading_msg.edit_text(
                error_msg,
                parse_mode=ParseMode.MARKDOWN
            )
            logger.error(f"Analytics command error: {e}")